0010 REM "Screen Editor - Display Module <ZZ2ASS>
0030 REM "(C) 1985 & 1986 by Basic Ideas, Inc; Norcross, Ga.
0035 REM "This software contains trade secrets and proprietary information"
0040 REM "and may not be reproduced in any form.
0500 DIM A[4,2]
0600 C5$=CHR(192)
1020 ENTER X3$,A1$,F0,W0,W1,V0$,W2,W3,W4,A1,V1$,V2$,E0,E1,E2,A0,E3,A2,E4,X4$
1030 A[0,0]=W2,A[1,0]=W3,A[2,0]=W4,E4=0
1060 IF A0=1 AND E2=0 THEN PRINT @(0,3),'CE',
1100 REM "
1120 IF E2>0 THEN GOTO 2000 ELSE GOTO 6000
2000 REM "CLEAR / PRINT ONLY DATA FIELDS; E2=1=CLEAR, 2=PRINT
2005 IF V1$="" THEN GOTO 9900
2010 IF E2=1 THEN PRINT 'CF',
2020 FOR P=1 TO LEN(V1$) STEP 4
2030 Q$=V1$(P,4),Q=NUM(Q$(3,2)),Y=NUM(Q$(1,2)); IF E2<>1 THEN GOSUB 7100
2040 IF E2=1 THEN PRINT @(Q,Y),C5$,
2080 NEXT P
2090 GOTO 9900
6000 REM "DISPLAY SCREEN - A0=1 MEANS WHOLE SCREEN,A1=1=REVERSE VIDEO
6010 PRINT 'SB',
6020 Q0=INT((A[0,0]-1)/W0),Q1=A[0,0]-Q0*W0
6100 FOR P=Q0 TO A[2,0]-1+Q0
6110 P0=P*W0+Q1
6120 Q$=V0$(P0,A[1,0]),X0=Q1-1,Y0=P+3
6125 GOSUB 6200
6130 NEXT P
6140 PRINT 'SF',
6190 GOTO 9900
6200 REM 
6205 IF A0=1 THEN IF POS(" "<>Q$)=0 THEN GOTO 6240
6210 IF E2=1 THEN GOTO 6240
6212 IF A1=1 THEN PRINT (0,ERR=6220)@(X0+E0,Y0+E1),'BH',Q$,'EH', ELSE PRINT @(X0+E0,Y0+E1),Q$,
6213 GOTO 6225
6220 REM PRINT @(X0+E0,Y0+E1),Q$,
6225 IF POS(C5$=Q$)>0 THEN E4=E4+1
6240 RETURN 
6260 IF V1$>"" THEN IF POS(STR(Y0+E1:"00")=V1$,4)>0 THEN GOSUB 7000
6290 RETURN 
7000 REM "CHECK FOR DATA FIELDS ON LINE Y0+E1
7010 P$=STR(Y0+E1:"00"),X=X0+E0,Y=Y0+E1,Q=POS(P$=V1$,4); IF Q=0 THEN RETURN 
7020 FOR Q=X TO A[1,0]
7030 Q$=P$+STR(Q:"00"); IF POS(Q$=V1$,4)>0 THEN GOSUB 7100
7060 NEXT Q
7080 RETURN 
7100 REM "DISPLAY DATA FIELD AT Q,Y
7110 FIND (F0,KEY=A1$(1,6)+" "+Q$)Q$
7130 Q$=Q$(12)
7140 W=0,W=NUM(Q$(11,3),ERR=7141)
7160 GOSUB 7200; IF E2=1 THEN DIM Z$(LEN(Z$))
7162 IF Q$(5,1)="M" THEN GOTO 7190
7165 R1=Q,R2=Y,R0=0,R0=NUM(Q$(88,2),ERR=7166)
7168 FOR R=0 TO R0
7170 PRINT @(R1,R2),Z$,
7172 IF POS(Q$(90,1)="Vv")>0 THEN R2=R2+1+NUM(Q$(91,1)) ELSE R1=R1+LEN(Z$)+NUM(Q$(91,1))
7180 NEXT R
7185 IF Q$(5,1)<>"V" THEN DIM F0$(NUM(Q$(17,3)),"V"); IF F0$>"" THEN PRINT (0,ERR=7186)@(NUM(Q$(121,2)),NUM(Q$(123,2))),F0$,
7190 RETURN 
7200 REM "DISPLAY
7205 ON POS(Q$(5,1)="DPTAMV") GOTO 7280,7210,7215,7220,7225,7400,7230
7210 Z$="MM/DD/YYYY"; GOTO 7380
7215 Z$="(XXX) XXX-XXXX Ext: XXXX"; GOTO 7380
7220 Z$="HH:MM xM"; GOTO 7380
7225 DIM Z$(NUM(Q$(11,3)),"X"); Z0$=Z$; CALL "ZZDISP",Q$(5,1)+"X",Z0$,Q$(14,3),X3$,Z$,"",0,0,X4$; GOTO 7380
7230 X$=Q$(14,8); CALL "ZZDISP",Q$(5,1)+"X","0",X$,X3$,Z$,"",0,0,X4$; GOTO 7380
7280 IF POS(Q$(5,1)="NC")=0 THEN DIM Z$(NUM(Q$(11,3)),"X"); GOTO 7380
7300 REM "NUMBER
7305 Z9$=Q$(11,3)+Q$(6,1); IF Q$(5,1)="C" THEN Z9$="922"+Q$(6,1)
7310 CALL "ZZMASK",Z9$,Z$
7380 IF Q$(5,1)="Q" THEN Z$="XXX"
7390 RETURN 
7400 REM "DISP ADDR MODULE
7405 DIM Z$(NUM(Q$(11,3)),"X")
7410 T0$=Q$(6,1); IF POS(Q$="AB")=0 THEN T0$="A"
7440 FOR R=0 TO 1
7445 CALL "ZY2AAA",ERR=7446,X3$,X4$,Q,Y,T0$,"",R,Z$,"",T0,0,0
7450 NEXT R
7490 RETURN 
8910 DEF FNS$(Z9$)=Z9$(1,POS("  "=Z9$+"  ")-1)
9900 REM "
9930 E2=0,A0=0
9940 EXIT 
9999 END 
