0010 REM "Input of item, item & specials in invoice line <AR2EAI>
0020 SETESC 9300; SETERR 9000
0035 REM "4.4 - 02/11/99 - 15.87 - dmm - SSP# 108985
0040 REM "Copyright 1999 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0100 SETERR 9000
0200 REM 
0210 D6$="*"
0220 J8=J7,J7=0; IF J8=2 OR J8=7 OR J8=8 THEN GOSUB 6500
0250 ON POS(B$(1,1)="NFICS") GOTO 9900,2400,2200,2650,2650,2300
0340 IOLIST D$
0350 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15],E[16],E[17],E[18],E[19],E[20],E[21],E[22],E[23],E[24],E[25],E[26],E[27],E[28],E[29],E[30]
0351 IOLIST E$,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15],E[16],E[17],E[18],E[19],E[20]
0352 IOLIST E$(1),E[0],E[1],E[2]
0370 IOLIST G$
0390 IOLIST P3$,P[0],P[1]
2200 REM "Custom forms
2205 IF D5$="*" THEN D5$=""; ON C0 GOTO 2210,2211
2208 B$(55,10)=A$(15,10),J3$=B$(55,10),J4$=B$(65,10)
2210 B$(65,10)=ITEM_CODE$ ! CALL "ZZENTR","SUX",B{ALL},B$,X4$,X3$,0,8,65,10,C0,"","{3"+X$,J3$,"AR2EAM92","FM1","",""; IF ABS(C0)=102 THEN J7=8; RUN "AR2EAN" ELSE IF ABS(C0)>4 THEN GOTO 6500
2215 IF B$(65,10)=J4$ AND (POS(" "<>B$(65,10))<>0 OR C0=-2) THEN GOTO 2690
2220 DIM E[20]; FIND (Z[10],KEY=B$(55,20),DOM=NO_ITEM)IOL=0351
2225 GOSUB 7500
2240 GOTO 9900
2300 REM "Special charges
2305 IF D5$="*" THEN D5$=""; ON C0 GOTO 2310,2311
2308 B$(55,10)="",J3$="X",J4$=B$(65,10)
2310 B$(65,10)=ITEM_CODE$ ! CALL "ZZENTR","SUX",B{ALL},B$,X4$,X3$,0,8,65,10,C0,"","{3"+X$,J3$,"AR2EAM82","FMPX","X",""; IF ABS(C0)=102 THEN J7=7; RUN "AR2EAN" ELSE IF ABS(C0)>4 THEN GOTO 6500
2315 IF B$(65,10)=J4$ AND (POS(" "<>B$(65,10))<>0 OR C0=-2) THEN GOTO 2690
2320 DIM E[20],E$(61); FIND (Z[2],KEY="X"+B$(65,10),DOM=2310)IOL=0352
2325 GOSUB 7900
2340 GOTO 9900
2400 REM "Non stock"
2405 GOTO 2440
2410 CALL "ZZENTR","SUX",B{ALL},B$,X4$,X3$,0,8,65,10,C0,"","{3"+X$,"","AR2EAM82","","",""; IF ABS(C0)>4 THEN GOTO 6500
2440 GOTO 9900
2650 REM "Item code
2654 IF C2$<>"*" THEN IF B$(1,1)="C" THEN GOTO 2700 ELSE B$(55,10)=""
2655 IF D5$="*" THEN D5$=""; ON C0 GOTO 2660,2661
2658 J3$=B$(55,10),J4$=B$(65,10)
2660 B$(65,10)=ITEM_CODE$ ! CALL "ZZENTR","AUX",B{ALL},B$,X4$,X3$,0,8,65,10,C0,"ICE","{3"+X$,J3$,"AR2EAM22","IC0","X",""; IF ABS(C0)=102 THEN J7=2; RUN "AR2EAN" ELSE IF ABS(C0)>4 THEN GOTO 6500
2665 IF B$(65,10)=J4$ AND (POS(" "<>B$(65,10))<>0 OR C0=-2) THEN GOTO 2690
2670 DIM E[30]; FIND (Z[5],KEY=B$(55,20),DOM=2660)IOL=0350
2675 GOSUB 7700
2690 IF B$(1,1)="C" AND ABS(C0)=2 THEN GOTO 2700 ELSE GOTO 9900
2700 REM "Input customer specific #
2701 C2$="*"
2703 IF D5$="*" THEN D5$=""; ON C0 GOTO 2710,2711
2704 IF POS(" "<>B$(55,10))=0 THEN B$(55,10)=A$(15,10)
2705 FIND (Z[3],KEY=B$(55,10),DOM=2706)C0$; GOSUB 2750
2710 B$(55,10)=CUSTOMER_2$ ! CALL "ZZENTR","AUX",B{ALL},B$,X4$,X3$,27,6,55,10,C0,"A/R","{3"+X$,"","AR2EAM23","AR1","",""; IF ABS(C0)>4 THEN GOTO 6500
2720 FIND (Z[3],KEY=B$(55,10),DOM=2710)C0$
2725 GOSUB 2760
2735 C2$=""
2740 IF ABS(C0)>1 THEN GOTO 9900 ELSE GOTO 2658
2750 REM "Cust spec. display
2755 ! PRINT @(19,6),'SB',"Cust #:",'SF',
2760 CUSTOMER_2$=B$(55,10) ! CALL "ZZDISP","A",B$(55,10),"A/R",X3$,"","",27,6,X4$
2765 C1$=FNS$(C0$(11,35)) ! PRINT @(0,21),'CL',@(40-INT(LEN(C1$)/2),21),C1$,
2790 RETURN 
6200 REM "Print one entry
6210 C9=0; PERFORM "ARGEAJ" ! CALL "ARGEAJ",X3$,X4$,B$,B{ALL},D7,H$,J0,G$,0,W$,M5$
6290 RETURN 
6500 REM "RE-DO SCREEN
6505 D5$="*"; RUN "ARGEAL"
7500 REM "Default fields then goto 7700's to finish & display
7510 B$(7,40)=E$(42,40),B$(3,3)=E$(21,3),B$(50,4)=E$(100,4),B$(93,18)=E$(24,18)
7515 B[2]=E[3],B[3]=E[1],B[6]=E[4],D7=E[4]
7517 IF E[2]=0 THEN B[3]=0 ELSE B[3]=E[1]*E[4]/E[2]
7520 GOTO 7720
7610 IF B[6]<>0 THEN B[4]=B[1]/B[6]*B[2],B[5]=B[1]/B[6]*B[3]
7620 GOSUB 8600
7635 SELL_PRICE_EXT=B[4],COST_EXT=B[5] ! @(69,10),'CL',@(69,11),'CL',
7636 B=B[4]-B[5] ! PRINT @(69,10),B:M1$,; IF B[4]<>0 THEN PRINT @(72,11),B*100/ABS(B[4]):"-###.00%",
7640 RETURN 
7710 B$(7,40)=E$(21,40),B$(3,3)=E$(61,3),B$(50,4)=E$(120,4),B$(93,18)=E$(64,18)
7715 B[2]=E[0],B[3]=E[18],B[6]=E[14],D7=E[14]
7716 IF D7=0 THEN D7=1
7717 PRECISION M5[1]; B[3]=E[18]*E[14]/E[15],B[0]=0,B[1]=0,B[4]=0,B[5]=0,B[7]=0; PRECISION 2
7720 DIM D$(40); FIND (Z[2],KEY="T"+B$(3,3),DOM=7721)IOL=0340
7725 B$(75,9)=D$(24,9)
7730 FIND (Z[12],KEY=B$(75,9),DOM=7731)IOL=0370
7735 GOSUB 8100
7740 GOSUB 8500
7780 GOSUB 6200
7790 RETURN 
7900 REM "Default fields then goto 7700's to finish & display
7910 B$(7,40)=E$(12,40),B$(3,3)=E$(52,3),B$(50,4)=E$(55,4)
7915 B[6]=E[0],D7=E[0]
7916 IF E$(61,1)="Y" THEN B[0]=0,B[1]=0,B[2]=0,B[3]=0,B[4]=E[1]+0,B[5]=E[2]+0 ELSE B[2]=E[1],B[3]=E[2]
7920 GOSUB 8200
7940 GOTO 7720
8100 REM "Set taxable to N if never taxed
8101 IF B$(54,1)="F" THEN IF A$(115,1)<>"Y" THEN IF D$(23,1)="N" THEN B$(54,1)="N"; GOTO 8130 ELSE GOTO 8130
8102 B$(54,1)="Y"; IF C9$="S" THEN B$(54,1)="" ELSE IF A$(115,1)="Y" THEN B$(54,1)="N"
8105 ON POS(D$(23,1)="NC") GOTO 8130,8110,8120
8110 B$(54,1)="N"; GOTO 8130
8120 IF B$(54,1)="Y" THEN B$(54,1)="C"
8130 TAXABLE$=B$(54,1)
8140 RETURN 
8200 REM "Set up for special of Costed freight
8210 IF E$(60,1)="Y" THEN B$(2,1)="Y" ELSE GOTO 8240
8220 B$(54,1)="F"
8230 IF C0<>-2 THEN X0=X0+10
8240 RETURN 
8500 REM "Set D7 for quantities
8504 FIND (Z[6],KEY="U/M"+B$(50,4),DOM=8590)IOL=0390
8505 IF P3$(20,1)="Y" THEN D7=P[1] ELSE D7=B[6]
8510 IF D7=0 THEN D7=1
8540 RETURN 
8600 REM "Calculate commission
8605 IF H$(31,1)="G" THEN B[7]=B[4]-(B[5]+B[5]*H[1]/100) ELSE B[7]=B[4]
8610 B[7]=B[7]*H[0]/100
8630 COMM_AMT=B[7]
8640 RETURN 
8900 REM "
8910 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9900,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9900
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6500
9520 ON C9 GOTO 1140,2040
9800 REM "EXIT PROGRAM
9900 REM "END PROGRAM
9910 D6$="*"
9950 EXIT ! RUN "ARGEAM"
9999 END 
10000 NO_ITEM: ITEM_CODE$="",NEXT_ID=ITEM_CODE.CTL; EXIT 
