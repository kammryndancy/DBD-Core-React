0010 ! ZZGLIB - Display Library Open
0035 ! "6.0 - 11/20/03 - 11.458333 - jir
0040 ! "Copyright 2003 Computer Software Inc.; Norcross, Georgia
0041 ! "        Licensed Software - All Rights Reserved.
1000 ! 1000 - Display open files
1010 DISP_OPNFLS:
1020 LIST_BOX LOAD OPNFL_LIST.CTL,""
1030 CHN_TBL$=CHN,I=0
1040 IF STP(CHN_TBL$,2)="" THEN GOTO END_DSP
1050 N=DEC($00$+CHN_TBL$(1,2)),CHN_TBL$=CHN_TBL$(3)
1060 FL.FIB$=FIB(N,ERR=1260)
1070 I=I+1
1080 FL.KSZ=DEC(FL.FIB$(11,1)),EXT_INFO$=""
1090 FL.KSZ$=STR(FL.KSZ:"###"),FL.RSZ$=""
1100 FL.RSZ=DEC(FL.FIB$(15,2))
1110 IF FL.FIB$(19,1)="*" THEN FL.TYP$="Device"; GOTO 1040
1120 IF FL.FIB$(19,1)="D" THEN FL.TYP$="Directory"; GOTO 1040
1130 IF FL.FIB$(19,1)="I" THEN FL.TYP$="Indexed"; FL.KSZ$="",EXT_INFO$="IND="+STR(IND(N,ERR=FILE_EOF)); GOTO 1040
1140 IF FL.RSZ=0 THEN FL.TYP$="Sort"; FL.RSZ$=""; GOTO 1040
1150 IF FL.FIB$(19,1)="S" THEN FL.TYP$="Serial"; FL.KSZ$=""; GOTO 1040
1160 IF FL.FIB$(19,1)="P" THEN FL.TYP$="Program"; GOTO 1010
1170 IF FL.FIB$(19,1)="B" THEN FL.TYP$="Binary/ISZ"; GOTO 1040
1180 IF FL.FIB$(19,1)="K" THEN FL.TYP$="Keyed"; EXT_INFO$="KEY="+KEY(N,END=FILE_EOF); GOTO 1210
1190 IF FL.FIB$(19,1)="X" THEN FL.TYP$="BBX Direct"; GOTO 1040
1200 IF FL.FIB$(19,1)="C" THEN FL.TYP$="CIsam" ELSE FL.TYP$="Unknown"; GOTO 1040
1210 IF AND($01$,FL.FIB$(17,1))=$01$ THEN FL.RSZ$="0-"+STR(FL.RSZ) ELSE FL.RSZ$=STR(FL.RSZ:"####0")
1220 P$=PTH(N) ! IF LEN(P$)>MAX_COL-37 THEN P$="..."+P$(LEN(P$)-(MAX_COL-41))
1230 ! DIM XX$(76," ")
1240 XX$=STR(N:"####0:")+SEP+PAD(FL.TYP$,10)+SEP+PAD(FL.RSZ$,8)+SEP+PAD(FL.KSZ$,3)+SEP+P$+SEP+STP(EXT_INFO$,2)
1245 IF POS("."+%Z__LANG$=P$)=0 THEN GOTO 1260
1246 IF POS("OPTION."=EXT_INFO$)<>0 OR POS("GU_OPN"=EXT_INFO$) THEN GOTO 1260
1247 ! XXX=POS($C6$=EXT_INFO$); IF XXX<>0 THEN EXT_INFO$(XXX,1)="F"; GOTO 1247
1250 LIST_BOX LOAD OPNFL_LIST.CTL,0,XX$
1260 IF CHN_TBL$<>"" THEN GOTO 1040
1270 END_DSP:
1280 IF I=0 THEN LIST_BOX LOAD OPNFL_LIST.CTL,0,"**** No files open ****"
1285 OPNFL_LIST.CTL'SORT=5
1290 EXIT 
1300 FILE_EOF:
1310 EXT_INFO$="<EOF>"; GOTO 1210
9999 END 
