0010 REM "Lookup for PMS numbers <FM2IT0>
0030 REM "(C) 1985,1986 Basic Ideas, Inc; Atlanta, Ga.
0035 REM "5.7 - 08/16/10 - 11.6525 - tma - SSP# 240435
0037 REM "240435-Compare of programs/panels from DEV to Release              
0040 REM "Copyright 2010 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0335 DEF FNS$(Z0$)=Z0$(1,POS("  "=Z0$+"  ")-1)
0510 IOLIST A$
0800 SETESC 5100; SETERR 9000
1020 ENTER X3$,X4$,L1$,Y9$,Y2$,Q0$,X0,X2,Y8,X5$,X2$,X3,X7$
1080 IF LEN(X5$)>0 THEN IF X5$(1,1)="N" THEN X4=1; IF X3=0 THEN X3=2
1090 L1$="FMQ1"
1105 DIM S$(20),F[20],N[20],Z9$(12,$00$)
1110 L1$=L1$+S$,Y9=LEN(Y9$),N0=-1,X$=$8A$
1120 Y0=3,Y0=NUM(L1$(1,2),ERR=1121),L1$=L1$(3)
1220 CALL "ZZFLES",X3$,Y3$,Y0$,"01O ZZL...  ",F{ALL},Z0,0; X0=0; ON Z0 GOTO 1221,9900
1300 REM "MULTIPLE
1480 FIND (F[1],ERR=9800,KEY=" "+L1$(1,8))L$
1482 IF X3$(239,1)<>" " THEN FIND (F[1],DOM=1483,KEY=X3$(239,1)+L1$(1,8))L9$; L$(10,30)=L9$(10,30),L$(62,264)=L9$(62,264),L9$=""
1485 IF NUM(L$(59,3))<=80 THEN T8=80 ELSE T8=NUM(L$(59,3))
1495 DIM D0$(T8,"-"),S0$(T8),P1$(T8+T8)
1496 DIM D0$(T8,X3$(235,1)); D0$=MNM('GS')+D0$+MNM('GE')
1510 T5$=X5$,F$="01C ZZL...  02O "; IF L$(43,3)="   " THEN F$=F$+L$(40,3)+"...  " ELSE F$=F$+L$(40,6)+"  "
1520 IF L$(46,6)<>S$(1,6) THEN F0=1,S0=NUM(L$(52,3)),T5$="S",F$=F$+"03O "+L$(46,3)+"...  "
1530 CALL "ZZFLES",X3$,Y3$,Y0$,F$,F{ALL},Z0,0; ON Z0 GOTO 1531,9900
1540 CALL "ZZINFO",F[2],Z0,X3$,R0,0,0,0,0,0,0,""; IF Z0>0 THEN R0=999
1905 IF X4=1 THEN Y1$=Y9$,Y8=1; GOTO 1960
1908 IF F0=1 THEN Y7=Y8,S1=S0
1910 DIM Y1$(Y8)
1915 IF R0<16 THEN GOTO 1950
1925 CALL "ZZPROM","X0ZZLIST",X3$,A,S8$,"","R",22
1928 PRINT @(0,23),S8$,; S8=LEN(S8$)+2
1930 CALL "ZZENTR",T5$+"U",X{ALL},Y1$,X4$,X3$,S8,23,1,Y8,C0,X2$,T1$,"","","","",""
1940 PRINT @(0,23),'CL',; IF ABS(C0)<>1 THEN GOTO 9900
1950 Y1$=Y9$+Y1$(1,Y8-1)+CHR(ASC(Y1$(Y8))-1)
1960 IF F0=1 THEN Y8=Y7; READ (F[3],KEY=Y1$,END=1990,DOM=1990) ELSE READ (F[2],KEY=Y1$,DOM=1990,END=1990,ERR=1990)IOL=0510
1990 IF X3<>1 THEN H9=0,H0=21,H3=T8 ELSE CALL "ZZPRIN","ZZLIST",X3$,Y0$,"",F{ALL},"H","",H0,H9,H2,H3,H4; N0$=X3$(86,40),L0=99,N0$=N0$(1,POS(S$=N0$+S$)-1); IF H4>0 THEN X0=0; GOTO 9900
2010 DIM A[3,16]; L=0,L9=1,M$="",M1$=""
2015 FOR X=1 TO 10
2020 L2$=L$(312+X*14,14); IF L2$(5,1)=" " THEN EXITTO 2041
2025 A[0,X]=NUM(L2$(1,1)),A[1,X]=NUM(L2$(2,3))+1,A[2,X]=NUM(L2$(6,3)),A[3,X]=NUM(L2$(9,3)),T$=T$+L2$(5,1),L=L+1,C$=C$+L2$(12,3)
2030 IF A[0,X]+1>L9 THEN L9=A[0,X]+1
2035 IF L2$(5,1)="N" THEN CALL "ZZMASK",L2$(9,3),M0$; A[3,X]=LEN(M$)+LEN(M0$)/100,M$=M$+M0$; IF A[2,X]>N0 THEN N0=A[2,X]
2040 NEXT X
2045 DIM P1$(132*L9)
2055 GOSUB 7100
2060 X6$=L$(5,POS("  "=L$(10,30)+"  ")-1)
2065 Y1=Y0,X0=1
2070 IF X3=1 THEN IF H2=2 THEN GOTO 2100 ELSE CALL "ZZPROM","X6ZZLIST",X3$,0,"+"+X6$,"","",23; GOTO 2100
2071 IF T8>80 THEN PRINT (0,ERR=7200)'T2',@(0,Y0),'CE',; FOR I=0 TO Y0-1; PRINT @(80,I),'CL',; NEXT I ELSE PRINT @(0,Y0),'CE',
2072 GOSUB 7030
2073 PRINT (0,ERR=2074)'SB',
2075 IF POS(" "<>L$(62,T8))<>0 THEN PRINT @(0,Y1),L$(62,T8),; Y1=Y1+1
2080 IF POS(" "<>L$(194,T8))<>0 THEN PRINT @(0,Y1),L$(194,T8),; Y1=Y1+1
2085 IF X3=0 THEN PRINT @(0,Y1),D0$; Y1=Y1+1
2086 PRINT (0,ERR=2087)'SF',@(0,Y1),
2090 L0=Y1,L8=0,L9$=""
2120 IF F0=1 THEN K$=KEY(F[3],END=2600); READ (F[3])J$; Y1$=K$(S1,6); READ RECORD (F[2],KEY=Y1$,DOM=2120,END=2600,ERR=2150)A$; GOTO 2160
2140 K$=KEY(F[2],ERR=2900,END=2600); READ RECORD (F[2],ERR=2900)A$; IF N0>=0 THEN GOSUB 4000
2160 IF Y9>0 THEN IF LEN(K$)<Y9 OR K$(1,Y9)<>Y9$ THEN GOTO 2600
2190 IF L0+L9>H0 THEN IF X3<>1 THEN GOTO 5000 ELSE GOSUB 3600
2220 L8=L8+1,L9$=L9$+K$,K8=LEN(K$)
2260 IF X3=0 THEN P1$(2,3)=STR(L8:"#0.")
2310 FOR X=1 TO L
2330 IF A[2,X]=0 THEN Q$=J$(17,6); GOTO 2341
2340 IF T$(X,1)<>"N" THEN Q$=A$(A[2,X],A[3,X])
2345 ON POS(T$(X,1)="DPNAT") GOTO 2390,2350,2355,2360,2365,2370
2350 CALL "ZZDISP","DX",Q$,"",X3$,X$,"",0,0,X4$; Q$=X$; GOTO 2390
2355 CALL "ZZDISP","PX",Q$,"",X3$,X$,"",0,0,X4$; Q$=X$; GOTO 2390
2360 N$=STR(N[A[2,X]]:M$(INT(A[3,X])+1,100*FPT(A[3,X])))
2361 CALL "ZZDISP","NMX",N$,"",X3$,Q$,"",0,0,X4$
2362 GOTO 2390
2365 CALL "ZZDISP","AX",A$(A[2,X],A[3,X]),C$(X*3-2,3),X3$,Q$,"",0,0,X4$; GOTO 2390
2370 CALL "ZZDISP","TX",Q$,"",X3$,X$,"",0,0,X4$; Q$=X$; GOTO 2390
2393 P1$(A[0,X]*T8+1+A[1,X],LEN(Q$))=Q$
2399 NEXT X
2420 FOR X=0 TO L9-1
2430 IF X=0 OR POS(" "<>P1$(X*T8+1,T8-1))>0 THEN PRINT (H9)P1$(X*T8+1,T8-1); L0=L0+1
2440 NEXT X
2450 DIM P1$(132*L9)
2590 GOTO 2110
2610 IF X3=1 THEN GOTO 3500 ELSE GOTO 5100
2910 IF ERR<>0 THEN GOTO 9000 ELSE CALL "ZZREAD",F[2],K$,A$,N{ALL},S8
2915 X$=K$,X$(LEN(X$))=CHR(ASC(X$(LEN(X$)))+1); READ (F[2],KEY=X$,DOM=2916)
2920 GOTO 2160
3505 L0$=X3$(239,1); CALL "ZZLANG",X3$,L0$
3520 PRINT (H9)'LF',FNS$(L0$(410,30)),": ",L8
3530 PRINT (H9)'FF','EA',
3540 PRINT @(0,22),'CL',
3550 GOTO 9900
3610 CALL "ZZHEAD","ZZLIST",X6$,N0$,X3$,"","","","",T8,L0,H9,H1,H0,H5,H6,"",""
3620 IF L$(62,T0)<>S0$ THEN PRINT (H9)L$(62,T8); L0=L0+1
3630 IF L$(185,T8)<>S0$ THEN PRINT (H9)L$(185,T8); L0=L0+1
3640 PRINT (H9)""; L0=L0+1
3690 RETURN 
4005 X$=$8A$
4010 DIM N[N0+1]; P0=POS(X$=A$),N=-1; IF P0=0 THEN GOTO 4085 ELSE P0=P0+1
4015 IF N>=N0 THEN GOTO 4085 ELSE P=POS(X$=A$(P0)); IF P=0 THEN GOTO 4085
4020 N=N+1,N[N]=NUM(A$(P0,P-1),ERR=4021),P0=P0+P
4050 GOTO 4015
4090 RETURN 
5020 IF X3=2 THEN CALL "ZZPROM","X1ZZLIST",X3$,A,"","","",0; ON A GOTO 5040,1900,9900 ELSE CALL "ZZPROM","X2ZZLIST",X3$,A,"","","V",N; ON A+1 GOTO 5080,5040,6600,1900,9900
5050 GOSUB 7000
5060 GOTO 2200
5080 IF N>0 AND N<=L8 THEN GOTO 5300 ELSE GOTO 5020
5120 IF X3=2 THEN CALL "ZZPROM","X3ZZLIST",X3$,A,"","","",N; ON A+1 GOTO 5140,9900,1900 ELSE CALL "ZZPROM","X4ZZLIST",X3$,A,"","","V",N; ON A+1 GOTO 5140,6600,1900,9900
5140 IF N>0 AND N<=L8 THEN GOSUB 5300 ELSE GOTO 5120
5150 GOTO 5120
5310 N=N-1,X2=N
5320 Q0=K8-Y9,Q0$=L9$(N*K8+Y9+1,Q0)
5340 GOTO 9900
6610 CALL "ZZPROM","S1ZZLIST",X3$,0,"","","",0
6615 Q$=""; FOR X=1 TO L8; Q$=Q$+$01$+CHR((X-1)*L9+Y1)+$03$+STR(X:"#0."); NEXT X
6620 CALL "ZZSLCT",X3$,"CX","000004","",Q$,"","",A1,B,Q4
6625 PRINT @(0,22),'CE'
6660 IF Q4<>B THEN GOTO 5000 ELSE N=Q4+1; GOTO 5080
7020 PRINT @(0,Y1),'CE',
7030 L0=Y1,L8=0,L9$=""
7090 RETURN 
7110 I0=POS("\"=L$)
7120 IF I0<57 OR I0+LEN(X7$)>321 THEN RETURN 
7140 IF POS("#"=X7$)<>0 THEN L$(I0,LEN(X7$))=STR(0:X7$) ELSE L$(I0,LEN(X7$))=X7$
7150 RETURN 
7210 T8=80; GOTO 2071
8205 IF Q$=$0D$ THEN C0=1; GOTO 8240 ELSE IF Q$=$08$ THEN C0=3; GOTO 8240
8220 Q9$=Q$,C0=-1,P=POS(Q9$=D2$,6); IF P=0 THEN RETURN ELSE GOTO 8235
8230 READ RECORD (D0,SIZ=1,TIM=0,ERR=8235)Q$; Q9$=Q9$+Q$; IF LEN(Q9$)>6 THEN GOTO 8235 ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230
8235 IF LEN(Q9$)>6 THEN PRINT 'RB',; RETURN ELSE P=POS(Q9$+Z9$(1,6-LEN(Q9$))=D2$,6); IF P=0 THEN GOTO 8230 ELSE C0=INT(P/6)+1,X3=C0
8240 C0=C0-1; RETURN 
9005 IF ERR=39 THEN GOTO 5100 ELSE IF ERR=33 THEN GOTO 9900
9010 E0=ERR,E1=TCB(5)
9040 CALL "ZZERRM",E0$,"ZZLIST",E1$,X3$,E0,E1,E2,E3,0
9190 GOTO 9900
9830 CALL "ZZPROM","X5ZZLIST",X3$,A,"","","",0; GOTO 9900
9905 IF T8<=80 THEN GOTO 9910
9906 IF X0>0 THEN PRINT 'CS',
9907 PRINT 'T1',
9910 CALL "ZZFLES",X3$,Y3$,Y0$,"END",Z{ALL},0,0
9915 PRINT @(0,21),'CE',
9920 EXIT 
9999 END 
