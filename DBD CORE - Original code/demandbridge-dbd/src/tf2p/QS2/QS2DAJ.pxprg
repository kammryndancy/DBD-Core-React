0010 REM "Set cost amounts and breaks <QS2DAJ>
0020 SETESC 9300; SETERR 9000
0035 REM "2.3.2
0040 REM "Copyright 1988 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0050 ON L2 GOTO 0051,9900
0100 SETERR 9000
0500 REM 
0510 GOSUB 6000
0515 GOSUB 6200
1000 REM 
1010 GOTO 2000
1800 REM "END
1820 CALL "ZZPROM","A",X3$,Z,"","","",0
1825 ON Z GOTO 2000,9900
2000 REM "DATA SEQ
2010 C0=0,X0=-1,X1=1,C9=1
2020 X$="",C0=ABS(C0),X0=X0+1; IF C0=2 THEN IF X0>0 THEN X0=X0-2
2025 IF C0>3 OR X0<0 THEN GOTO 1800
2040 IF X0>23 THEN GOTO 1800 ELSE IF MOD(X0,2)=0 THEN GOTO 2100 ELSE GOTO 2150
2100 REM "Quantity break
2103 P0=X0/2+1
2104 IF P0>1 THEN IF E[P0-1]=0 THEN GOTO 2020
2105 IF P0>6 THEN P1=47 ELSE P1=7
2106 IF P0>6 THEN P2=7+P0 ELSE P2=13+P0
2109 DIM Q[1]; Q[1]=E[P0]/U0
2110 CALL "ZZENTR","N.X",Q{ALL},A$,X4$,X3$,P1,P2,1,822,C0,M4$,"{3"+X$,"","QS2DAJ02","","",""
2120 IF C0>0 THEN E[P0]=Q[1]*U0
2125 IF E[P0]=0 THEN GOSUB 7000
2140 GOTO 2020
2150 REM "Cost
2153 P0=INT(X0/2)+1
2154 IF P0>1 THEN IF E[P0]=0 THEN GOTO 2020
2155 IF P0>6 THEN P1=63 ELSE P1=23
2156 IF P0>6 THEN P2=7+P0 ELSE P2=13+P0
2157 P3=P0+12
2160 CALL "ZZENTR","NX",E{ALL},A$,X4$,X3$,P1,P2,P3,621,C0,M3$,"{3"+X$,"","QS2DAJ04","","",""
2167 P3=P0+12
2190 GOTO 2020
6000 REM "Background"
6010 PRINT 'SB',
6020 PRINT @(0,13),'CE',
6030 PRINT @(10,13),"Quantity",@(27),"Cost",@(50),"Quantity",@(67),"Cost",
6165 PRINT 'SF',
6190 RETURN 
6200 REM "Display"
6205 I0=7,I1=14
6210 FOR I=1 TO 12
6215 IF I=7 THEN I0=47,I1=14
6220 IF E[I]=0 THEN EXITTO 6241
6225 PRINT @(I0,I1),E[I]/U0:M4$,@(I0+15),E[I+12]:M5$,
6230 I1=I1+1
6240 NEXT I
6390 RETURN 
7000 REM "Fix up array and display after entry of a zero
7004 REM "F9 is flag to see if redisplay needs to be done
7005 E[P0+12]=0,F9=0
7010 FOR I=P0 TO 11
7015 IF E[I+1]<>0 THEN F9=1,E[I]=E[I+1],E[I+12]=E[I+13],E[I+1]=0,E[I+13]=0
7020 NEXT I
7030 IF F9=0 THEN PRINT @(P1,P2),'CL', ELSE X0=X0-1; PRINT @(0,14),'CE',; GOSUB 6200
7040 RETURN 
7600 REM "Refigure unit price based on desired g.p.
7605 PRECISION 14
7610 T9=1-A[I+5]/100
7611 IF T9=0 THEN T9=99.99
7619 PRECISION 2
7620 A[I+10]=A[I+17]/T9
7640 RETURN 
8000 REM "Figure costs for selling breaks
8005 H1=1
8007 IF H1=12 THEN GOTO 8010 ELSE IF E[H1+1]=0 THEN GOTO 8010 ELSE H1=H1+1; GOTO 8007
8010 FOR I=2 TO 6; GOSUB 8100; NEXT I
8090 RETURN 
8100 REM "Given selling break A(I) compute cost
8105 H2=2
8110 IF H2=H1+1 THEN H2=H1; GOTO 8120
8115 IF A[I]<E[H2] THEN H2=H2-1; GOTO 8120 ELSE H2=H2+1; GOTO 8110
8124 IF U0=0 THEN GOTO 8126
8125 REM LET A(I+17)=E(H2+12)*(S0*S1/(U0*U1))
8126 A[I+17]=E[H2+12]*S0*S1/(U0*U1)
8130 IF A[I+5]<>0 THEN GOSUB 7600
8140 RETURN 
9000 REM "ERROR PROCESSING
9005 IF ERR=69 THEN GOTO 9500
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,"QS2DAJ",Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9500 REM "CTRL LOGIC
9510 SETERR 9000; GOSUB 6400
9520 ON C9 GOTO 1140,2040
9600 REM "RUN ESTIMATE PROGRAM
9700 REM "PROG FLOW
9710 IF U1$="" THEN REMOVE (Z[13],KEY=U0$,DOM=9900); GOTO 9900
9720 WRITE (Z[13],KEY=U0$)U0$,U1$
9730 RUN U1$(1,6)
9800 REM "EXIT PROGRAM
9810 IF U0$>"" THEN GOTO 9700
9900 REM "END PROGRAM
9910 GOSUB 8000
9950 RUN "QS2DAB"
9999 END 
