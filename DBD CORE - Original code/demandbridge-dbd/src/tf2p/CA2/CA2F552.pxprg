0010 REM "Specifc fixes for company 552 <CA2F552>
0020 SETESC 9300; SETERR 9000
0035 REM "3.8 - 05/03/95 - 16.42 - jtb
0040 REM "Copyright 1995 Computer Software Inc.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 0100; ENTER X3$,X4$,CA0$,R$,SKIP
0100 SETERR 9000
0110 X0$="CA2F552",X1$="Specific fixes for company 552"
0200 REM 
0205 SKIP=0
1000 REM "Process r$
1005 P=POS(CA0$(1,4)="AR1 FM0 AP4 "); IF P=0 THEN GOTO 9900 ELSE P=(P+3)/4
1010 ON P GOSUB 9900,1100,1150,1200,9900; GOTO 9900
1100 REM "AR1 records
1105 IF R$(1,3)="WHA" OR R$(18,4)="WOLL" OR (R$(18,14)="VIKING FREIGHT" AND R$(1,4)<>"9361") OR (R$(18,11)="VALLEY OAKS" AND R$(1,4)<>"9305") OR R$(1,2)="PC" OR R$(18,7)="PATELCO" OR (POS(R$(1,1)="DP")<>0 AND FN%NMV(R$(2,1))=1) THEN SKIP=1
1110 IF R$(1,4)="1010" THEN R$(286,4)="R" ELSE IF R$(1,4)="3040" THEN R$(286,4)="W" ELSE IF R$(1,4)="3275" OR R$(1,4)="5806" THEN R$(286,4)="D" ELSE IF R$(1,4)="3950" OR R$(1,4)="8400" THEN R$(286,4)="I"
1145 RETURN 
1150 REM "FM0 records
1152 IF R$(1,3)="WHA" THEN R$(1,21)="9551X"
1154 IF R$(26,8)="WOLLBORG" THEN R$(1,21)="9670X"
1156 IF R$(26,14)="VIKING FREIGHT" THEN R$(203,9)=R$(1,9),R$(230,20)=R$(1,20),R$(1,21)="9361X"
1158 IF R$(26,11)="VALLEY OAKS" THEN R$(1,21)="9305X"
1160 IF R$(1,2)="PC" THEN IF FN%NMV(R$(3,4))=1 THEN R$(22,4)=STR(NUM(R$(3,4)):"0000") ELSE R$(22,4)=R$(3,4) END_IF ; R$(1,21)="6450X"
1162 IF R$(26,7)="PATELCO" THEN R$(203,9)=R$(1,9),R$(230,20)=R$(1,20),R$(1,21)="6403X"
1164 IF POS(R$(1,1)="DP")<>0 AND FN%NMV(R$(2,1))=1 THEN IF FN%NMV(R$(2,4))=1 THEN R$(22,4)=STR(NUM(R$(2,4)):"0000") ELSE R$(22,4)=R$(2,4) END_IF ; R$(203,9)=R$(1,9),R$(230,20)=R$(1,20); IF R$(1,1)="D" THEN R$(1,21)="D9500" ELSE R$(1,21)="P7700"
1195 RETURN 
1200 REM 'AP4
1202 IF STP(R$(196,20),3," ")="" THEN R$(196,20)="BLANK"
1249 RETURN 
9000 REM "Errors
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9045 REM 
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9055 REM 
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 0990
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "END PROGRAM
9930 SETERR 9940; EXIT 
9940 SETESC 9350
9950 RUN "ZMENU"
9999 END 
