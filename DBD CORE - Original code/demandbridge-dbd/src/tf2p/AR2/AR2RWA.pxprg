0010 REM "Sales Tax Payable  For Veratax downloaded tax file<AR2RWA>
0035 REM "5.7 - 11/05/19 - 10.835277 - jvv - SSP# 307229
0037 REM "307229-Security by Operator to prevent clearing of Sales Tax Payabl
0040 REM "Copyright 2019 Demand Bridge, LLC.; Norcross, Georgia
0041 REM "        Licensed Software - All Rights Reserved.
0090 CLEAR ; SETERR 9000
0095 PRECISION 14; T2=TIM; PRECISION 2
0105 SETERR 9000; SETESC 9300
0110 X0$="AR2WHA",X1$="Sales Tax Payable - Downloaded Tax File"
0120 DIM A$(51),A[14],B$(190),B[2],C$(37),D$(190); REM SSP 208463!SSP#235278
0140 Z0$="#####,###.00-",Z1$="###,###.00-",Z2$="##,###.00-",Z3$="###,###.00-"
0160 DEF FNP$(Z9$)="("+Z9$(1,3)+") "+Z9$(4,3)+"-"+Z9$(7,4)+" Ext: "+Z9$(11,4)
0165 DEF FND$(Z9$)=Z9$(NUM(X3$(48,1))*2+1,2)+X3$(59,1)+Z9$(7-NUM(X3$(48,1))*2,2)+X3$(59,1)+STR((ASC(Z9$(1,1))-65)*10+1900+NUM(Z9$(2,1))-1570*POS("  "=Z9$(1,2)):"####")
0166 DEF FNE$(Z9$)=Z9$(3,2)+X3$(59,1)+STR(MOD(ASC(Z9$(1,1))-65,10)*10+NUM(Z9$(2,1)):"00"); REM " NOT USED BUT CONVERTED FOR 2000
0170 DEF FNT$(Z9$)=STR(NUM(Z9$(1,2))-12*POS("13"<=Z9$(1,2),2)+12*POS("00"=Z9$(1,2)):"00")+":"+STR(NUM(Z9$(3,2))*.6:"00")+" "+CHR(65+15*POS("12"<=Z9$(1,2),2))+"M"
0175 DEF FNS$(Z9$)=Z9$(1,POS("   "=Z9$+"   ")-1)
0210 T=1,T0=0,T1=15
0220 W3=213
0225 W=999
0230 DIM T1$(W3,"-"),T2$(W3,"="),T3$(W3,"*"),Y5$(W3),Y6$(W3)
0240 CALL "ZZCOMP",X0$,X1$,X2$,X3$,X4$,"",-1,X1,X2; IF X1>0 THEN GOTO 9920
0245 IF X3$(66,1)>"2" THEN PRECISION NUM(X3$(66,1),ERR=0246)
0300 REM "I/O lists
0305 REM "IOLIST FOR ARL - Sales tax payable
0310 IOLIST A$,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14]
0315 REM "IOLIST FOR AR5 - Sales Tax Masterfile
0320 IOLIST B$,B[0],B[1],B[2]
0330 IOLIST C$
0340 IOLIST D$
0350 IOLIST ST$,TT2[0],TT2[1],TT2[2],TT2[3],TT2[4],TT2[5],TT2[6],TT2[7],TT2[8],TT2[9],TT2[10],TT2[11],TT2[12],TT2[13],TT2[14],TT2[15]
0420 IOLIST X3$,X4$,V1$,V3$,V2$,V0$
0500 REM "Files
0505 DIM Z[NUM(X3$(60,3))]; GOSUB 7400
0510 Y$="01O ARL...  02O AR5...  06O ZZPARM  "
0520 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
0525 READ (Z(6),KEY=X3$(9,3)+"A/R",DOM=9900)AR_PARMS$
0530 IF MID(AR_PARMS$,176,1)="Y" AND V0$(74,1)="Y" THEN W3=213 ELSE W3=131
0535 DIM T1$(W3,"-"),T2$(W3,"="),T3$(W3,"*"),Y5$(W3),Y6$(W3)
0538 READ (Z[6],KEY="osec"+X3$(40,3),DOM=*NEXT)OP_SECURITY$ ! ssp 307229
0540 F0$="[256]{A}Sales Tax Accumulator Workfile"
0542 READ (Z[6],KEY=X3$(9,3)+"AR1")P0$
0544 F0$="[256]{A}Sales Tax Accumulator Workfile"
0545 CALL "ZZ2SRT",X3$,X4$,Z[13],-10,10,F0$,F1,"NN"
0550 IF F1=2 THEN GOTO 9900
0555 IF LEN(F0$)<8 THEN F0$=PAD(F0$,8)
0560 Z$="11O "+F0$
0565 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,Z1
0620 REM " Add to Archive - SSP# 149046
0630 R6$="N"; IF V3$(2,1)<>"T" THEN CALL "ZR2DGP",ERR=0631,X3$,X4$,"SALES_TAX ",R6$
0632 REM "KEY$=DTE(0:"%Hz%mz%sz")
0633 KEY$=V2$(1,4)+V2$(9,2)
0634 REM "KEY$=V2$(1,4)+V2$(9,2)+V2$(5,4)+V2$(11,2)
0635 IF R6$(1,1)="Y" THEN T9$=KEY$; CALL "ZR2DND",ERR=0636,X3$,X4$,T9$,"",R6$; REM "Signal start of a new document, the key is system dat e+audit control #                                                          
0636 REM "IF R6$(1,1)="Y" THEN T9$=X3$(21,6)+KEY$; CALL "ZR2DND",ERR=0636,X3$,X4$,T9$,"",R6$; REM "Signal start of a new document, the key is system dat e+audit control #                                                          
0700 REM "Open Printer
0720 REM 
0800 REM "Alternate Sort Info & total dim"
0805 DIM U0$(4)
0810 ON V0 GOTO 0820,0820,0830,0840
0820 DIM U[5]; U=66,U0=5,U[0]=0,U[1]=6,U[2]=2,U[3]=25,U[4]=25,U[5]=8,T0=4,V1=6,V2=2,V3=25,V4=3,U0$="Y   ",T5$="S   S   S   S   ",U5$="Fiscal year",U6$="",U7$="",U8$=""; GOTO 0850
0821 REM "DIM U[4]; U=24,U0=3,U[0]=0,U[1]=6,U[2]=10,U[3]=8,T0=4,V1=6,V2=2,V3=4,V4=4,U0$="Y   ",T5$="S   S   S   S   ",U5$="Fiscal year",U6$="",U7$="",U8$=""; GOTO 0850
0850 DIM T[T0,T1],TT1[T1],TT2[T1]
0860 V5=V1+1,V6=V5+V2,V7=V6+V3
0895 CALL "ZZPRIN",X0$,X3$,Y0$,V3$,Z{ALL},W8$,W9$,W0,W9,W2,W3,W4; ON W4 GOTO 0896,9920
0900 REM " Position read"
0905 REM "set key file to read from"
0910 CALL "ZZFLES",X3$,Y1$,Y0$,"00O "+V1$+"  ",Z{ALL},Z0,0; IF Z0>0 THEN GOTO 9900 ELSE U1=Z[0]
0930 IF LEN(V2$)>=U*2 THEN GOTO 0965
0934 REM "create default 'all' range key
0935 DIM V2$(U*2),V4$(U,"~"); U3=1
0940 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1]
0950 V2$(U3+U[U9],U[U9])=V4$(1,U[U9])
0955 NEXT U9
0964 REM "Get starting key from range key
0965 DIM V4$(U); U3=1,U4=1
0967 IF Q5<>1 THEN V2$=V2$(1,4)+V2$(9,2)+V2$(5,4)+V2$(11); REM " YEAR AND PERIOD
0970 FOR U9=1 TO U0; U3=U3+U[U9-1]+U[U9-1],U4=U4+U[U9-1]
0975 V4$(U4,U[U9])=V2$(U3,U[U9])
0980 NEXT U9
0985 V4$(U,1)=CHR(ASC(V4$(U,1))-1)
0990 READ (U1,KEY=V4$,DOM=0991)
1000 REM "Read next record
1005 U$=KEY(U1,END=5000)
1008 REM "check key against range info"
1009 U3=1,U2=1
1010 FOR U9=1 TO U0; U2=U2+U[U9-1],U3=U3+U[U9-1]+U[U9-1]
1020 IF U$(U2,U[U9])>=V2$(U3,U[U9]) THEN GOTO 1030 ELSE EXTRACT (U1,KEY=U$(1,U2-1)+V2$(U3,U[U9]),DOM=1021)
1025 EXITTO 1000
1030 IF U$(U2,U[U9])<=V2$(U3+U[U9],U[U9]) THEN GOTO 1040 ELSE READ (U1,KEY=U$(1,U2-1)+$FF$,DOM=1032)
1035 EXITTO 1000
1040 NEXT U9
1100 REM "Get record"
1110 REM "U9$=U$
1120 ON V0 GOTO 1150,1150,1130,1140
1150 U_KEY$=MID(U$,1,6)+MID(U$,67,10)+MID(U$,59,8) ! 240377
1151 U9$=U$
1152 READ (Z[1],KEY=U_KEY$,DOM=*NEXT)IOL=0310 ! 240377
1153 READ (U1)
1155 IF X3$(9,3)="074" AND POS(A$(25,2)="1020",2)>0 THEN GOSUB 5900; REM "Centurion modification 2/5/98 cwj
1158 REM "IF X3$(9,3)="500" AND POS(A$(25,2)="001020",2)>0 THEN GOSUB 05900; REM "CENTURION MODIFICATION TEST LINE 2/5/98 CWJ ... SHOULD BE REMMED AT CLIENT SITE!
1165 IF Q6=1 THEN GOTO 8200 ELSE IF Q5=1 THEN REMOVE (U1,KEY=U$,DOM=1000); REMOVE (Z[1],KEY=U_KEY$,ERR=*PROCEED); C=C+1; IF MOD(C,T0)=1 THEN GOSUB 8150; GOTO 1000 ELSE GOTO 1000 ! 240377
1300 REM "Read other data
1310 B0$=B$,C0$=C$,D0$=D$
1315 IF A$(7,2)+"        "=B$(1,10) THEN GOTO 1321
1320 DIM B$(LEN(B$)); FIND (Z[2],DOM=1321,KEY=A$(7,2)+"        ")IOL=0320
1330 DIM C$(LEN(C$)); IF A$(9,4)<>"    " THEN FIND (Z[2],DOM=1331,KEY=A$(7,6)+"    ")IOL=0330
1340 DIM D$(LEN(D$)); IF A$(13,4)<>"    " THEN FIND (Z[2],DOM=1341,KEY=A$(7,10))IOL=0340
1400 REM "Subtotals"
1415 GOSUB 3100
1420 ON T GOTO 1470,1430,1440,1450,1460
1430 GOSUB 6200
1440 GOSUB 6300
1450 GOSUB 6400
1460 GOSUB 6500
1490 T=0
1500 REM "Print Data
1505 DIM TT1[T1]
1510 IF W+1>W0 THEN GOSUB 6000
1515 CALL "ZZDISP","AX",A$(17,8),"AR6",X3$,X$,"",0,0,X4$; Y5$(1)=X$
1520 IF A[0]<>A[1] THEN Y5$(10)="*"
1521 IF MID(A$,9,3)<>"w/o" THEN A1=A[1]-A[4]-A[6]-A[8] ELSE A1=0
1524 CALL "ZZDISP","AX",A$(25,10),"A/R",X3$,X$,"",0,0,X4$; Y5$(11)=X$ ! SSP#248556
1525 Y5$(22)=STR(A1-A[3]:Z1$),Y5$(35)=STR(A[3]:Z1$),Y5$(48)=STR(A[4]:Z2$) ! SSP#253425
1526 TT1[1]=A1-A[3],TT1[2]=A[3],TT1[3]=A[4]; REM "DXM
1530 IF POS(" "<>A$(9,4))<>0 THEN Y5$(58)=STR(A1-A[5]:Z1$),Y5$(71)=STR(A[5]:Z1$),Y5$(84)=STR(A[6]:Z2$),TT1[4]=A1-A[5],TT1[5]=A[5],TT1[6]=A[6]; REM "DXM
1534 REM "IF POS(" "<>A$(13,4))<>0 THEN Y5$(96)=STR(A1-A[7]:Z1$),Y5$(109)=STR(A[7]:Z1$),Y5$(122)=STR(A[8]:Z2$),TT1[7]=A1-A[7],TT1[8]=A[7],TT1[9]=A[8]; REM "DXM
1535 Y5$(96)=STR(A1-A[7]:Z1$),Y5$(109)=STR(A[7]:Z1$),Y5$(122)=STR(A[8]:Z2$),TT1[7]=A1-A[7],TT1[8]=A[7],TT1[9]=A[8]; REM "DXM
1536 IF V0$(74,1)="Y" THEN Y5$(133)=STR(A[9]:Z1$),Y5$(145)=STR(A[10]:Z1$),Y5$(157)=STR(A[11]:Z1$),Y5$(168)=STR(A[12]:Z1$),Y5$(180)=STR(A[13]:Z1$),Y5$(192)=STR(A[14]:Z1$); TT1[10]=TT1[10]+A[9],TT1[11]=TT1[11]+A[10],TT1[12]=TT1[12]+A[11],TT1[13]=TT1[13]+A[12],TT1[14]=TT1[14]+A[13],TT1[15]=TT1[15]+A[14]
1540 IF V0$(73,1)="Y" THEN GOSUB 6600
1545 REM "IF R6$(1,1)="Y" THEN T9$=A$(1,24); CALL "ZR2DND",ERR=0636,X3$,X4$,T9$,"",R6$; REM "Signal start of a new document, the key is system dat e+audit control #                                                          
1550 GOSUB 7300
1900 REM "Accumulate Totals"
1910 T[T0,1]=T[T0,1]+A1-A[3],T[T0,2]=T[T0,2]+A[3],T[T0,3]=T[T0,3]+A[4],T[T0,10]=T[T0,10]+A[9],T[T0,13]=T[T0,13]+A[12]
1920 IF POS(" "<>A$(9,4))<>0 THEN T[T0,4]=T[T0,4]+A1-A[5],T[T0,5]=T[T0,5]+A[5],T[T0,6]=T[T0,6]+A[6],T[T0,11]=T[T0,11]+A[10],T[T0,14]=T[T0,14]+A[13]
1930 T[T0,7]=T[T0,7]+A1-A[7],T[T0,8]=T[T0,8]+A[7],T[T0,9]=T[T0,9]+A[8],T[T0,12]=T[T0,12]+A[11],T[T0,15]=T[T0,15]+A[14]
1931 REM "IF POS(" "<>A$(13,4))<>0 THEN T[T0,7]=T[T0,7]+A1-A[7],T[T0,8]=T[T0,8]+A[7],T[T0,9]=T[T0,9]+A[8],T[T0,12]=T[T0,12]+A[11],T[T0,15]=T[T0,15]+A[14]
1990 T[T0,0]=T[T0,0]+1
1995 GOTO 1000
3000 REM "Subtotaling Routines"
3050 REM "Add to T$ for total title, T & T5 should be set
3055 T7$=T5$(T*4-3,4)
3060 IF T7$(1,1)=" " THEN RETURN 
3070 IF T7$(1,1)<>"S" THEN CALL "ZZDISP",T7$(1,1)+"X",T6$,T7$(2,3),X3$,T6$,"",0,0,X4$
3080 IF T$="" THEN T$=T6$ ELSE T$=T$+" "+T6$
3090 RETURN 
3100 REM "High order break"
3110 IF V1=0 THEN RETURN ELSE IF U1$=U9$(1,V1) THEN GOSUB 3200; RETURN 
3120 GOSUB 3220
3130 IF U1$="" THEN GOTO 3160
3150 T=1,T$="FY:"+U1$(1,4)+" PD:"+U1$(5,2),T6$=""; GOSUB 3050; GOSUB 7000
3155 IF U0$(1,1)="Y" THEN GOSUB 6000
3160 U1$=U9$(1,V1)
3180 RETURN 
3200 REM "Second highest order break"
3210 IF V2=0 THEN RETURN ELSE IF U2$=U9$(V5,V2) THEN GOSUB 3300; RETURN 
3220 GOSUB 3320
3230 IF U2$="" THEN GOTO 3260
3250 T=2,T$=U6$,T6$=U2$; GOSUB 3050; GOSUB 7000
3255 IF U0$(2,1)="Y" THEN GOSUB 6000
3260 U2$=U9$(V5,V2)
3280 RETURN 
3300 REM "Next to lowest order break"
3310 IF V3=0 THEN RETURN ELSE IF U3$=U9$(V6,V3) THEN GOSUB 3400; RETURN 
3320 GOSUB 3420
3330 IF U3$="" THEN GOTO 3360
3350 T=3,T6$="",T$=U2$+"-"+U3$; GOSUB 3050; IF POS(" "<>U3$)=0 THEN GOSUB 7100 ELSE GOSUB 7000
3355 IF U0$(3,1)="Y" THEN GOSUB 6000
3360 U3$=U9$(V6,V3)
3380 RETURN 
3400 REM "lowest order break"
3410 IF V4=0 THEN RETURN ELSE IF U4$=U9$(V7,V4) THEN RETURN 
3430 IF U4$="" THEN GOTO 3460
3450 T=4,T6$="",T$=U2$+"-"+U3$+"-"+U4$; GOSUB 3050; IF POS(" "<>U4$)=0 THEN GOSUB 7100 ELSE GOSUB 7000
3455 IF U0$(4,1)="Y" THEN GOSUB 6000
3460 U4$=U9$(V7,V4)
3480 RETURN 
5000 REM "End of Print
5005 END$="*"
5010 IF Q5=1 THEN GOTO 5400
5020 IF W8=0 THEN GOTO 5290
5030 T0$="END"
5040 IF V1>0 THEN GOSUB 3120
5045 IF V0$(73,1)="Y" THEN GOSUB 6800
5050 T=0,T$="Report"; GOSUB 7000
5200 REM "
5210 T9=1
5290 GOTO 9900
5300 REM "Purge records
5305 IF %TOD THEN GOTO *RETURN ! SSP 240570 ! SSP243169 jdf
5308 IF MID(OP_SECURITY$,171,1)="Y" THEN GOTO 5390 ! ssp 307229 User does not have security to delete records
5310 CALL "ZZPROM","X0AR2RHA",X3$,Z,"","","",0; ON Z GOTO 5311,5390
5320 GOSUB 8100
5325 PRINT @(20,17),"Removing printed sales tax records",
5360 Q5=1; GOTO 0900
5390 RETURN 
5400 REM "Do AS3 file if needed
5405 IF Q6=1 OR P0$(63,1)<>"Y" THEN GOTO 9920
5410 Q6=1
5420 Y$="05O TMP"+FID(0)+"   07O AS3...  "; REM "use sort file generated by AR2RHB
5425 CALL "ZZFLES",X3$,Y1$,Y0$,Y$,Z{ALL},Z0,Z1
5430 U1=Z[5]
5432 GOSUB 8100
5433 PRINT @(20,17),"Removing printed detail sales tax records",
5435 GOTO 0965
5900 REM "Zero Out Sales Tax: Centurion Change 2/5/98 cwj
5920 Q0=0
5930 FOR X=4 TO 8 STEP 2
5935 Q0=Q0+A[X],A[X]=0,A[X-1]=0
5940 NEXT X
5945 A[0]=A[0]-Q0,A[1]=A[1]-Q0,Q0=0
5948 RETURN 
6000 REM "Page header
6020 W0$="Fiscal Year: "+A$(1,4)+"  "+"Accounting Period: "+A$(5,2)
6035 IF T0$="END" THEN W0$=""
6037 IF END$="*" AND V0$(73,1)="Y" THEN W0$="Recap Totals"
6040 CALL "ZZHEAD",X0$,X1$,X2$,X3$,W0$,W1$,W2$,W9$,W3,W,W9,W8,W0,W5,W2,W8$,W5$; IF T0$="END" THEN GOTO 6060 ELSE ON W5 GOTO 6041,9910
6045 ON W5 GOTO 6046,9900
6060 GOSUB 6100
6090 RETURN 
6100 REM "
6125 Y5$(26)="Non-taxable",Y5$(39)="Taxable",Y5$(63)="Non-taxable",Y5$(76)="Taxable",Y5$(100)="Non-taxable",Y5$(113)="Taxable"
6126 IF V0$(74,1)="Y" THEN Y5$(140)="Cust Owned Taxable Sales",Y5$(173)="Cust Owned Non-taxable Sales"
6130 GOSUB 7300
6135 Y5$(1)="Invoice",Y5$(12)="Customer",Y5$(29)="Sale",Y5$(41)="Sale",Y5$(48)="Sales tax",Y5$(66)="Sale",Y5$(78)="Sale",Y5$(85)="Sales tax",Y5$(103)="Sale",Y5$(115)="Sale",Y5$(123)="Sales tax"
6136 IF V0$(74,1)="Y" THEN Y5$(140)="State",Y5$(151)="County",Y5$(163)="Local",Y5$(174)="State",Y5$(186)="County",Y5$(197)="Local"
6140 GOSUB 7300
6145 GOSUB 7300
6199 RETURN 
6200 REM "Break #1 header
6299 RETURN 
6300 REM "Break #2 header
6399 RETURN 
6400 REM "Break #3 header
6410 IF B$(190,1)="Y" THEN USE_TAX$="*" ELSE USE_TAX$=" " ! SSP 219370
6420 X5$=A$(7,2)+USE_TAX$+" "+FNS$(B$(11,25)); Y5$(38-INT(LEN(X5$)/2))=X5$ ! SSP 219370
6499 RETURN 
6500 REM "Break #4 header
6510 IF W+2>W0 THEN GOSUB 6000
6515 GOSUB 7300
6520 X5$=A$(7,2)+" "+FNS$(MID(D$,157,25)); Y5$(38-INT(LEN(X5$)/2))=X5$
6530 IF POS(" "<>A$(9,5))<>0 THEN X5$="Zip: "+A$(9,5)+"  County: "+" "+FNS$(MID(D$,121,25)),Y5$(76-INT(LEN(X5$)/2))=X5$
6540 IF POS(" "<>A$(14,3))<>0 THEN X5$="Geo: "+A$(14,3)+"   City: "+" "+FNS$(D$(79,25)),Y5$(114-INT(LEN(X5$)/2))=X5$
6550 GOSUB 7300
6599 RETURN 
6600 REM "ACCUMULATE SALES TAX TOTALS
6610 DIM TT2[T1]
6620 ST$=A$(7,2)
6630 READ (Z[11],KEY=ST$,DOM=6631)IOL=0350
6640 FOR TT=1 TO T1; TT2[TT]=TT2[TT]+TT1[TT]; NEXT TT
6650 WRITE (Z[11],KEY=ST$)IOL=0350
6690 RETURN 
6700 REM PRINT RECAP DETAIL
6710 IF W+1>W0 THEN GOSUB 6000
6715 REM "IF ST$(3,3)<>"w/o" THEN A1=TT2[1]-TT2[4]-TT2[6]-TT2[8] ELSE A1=0
6720 Y5$(1)=ST$
6725 Y5$(21)=STR(TT2[1]:Z1$),Y5$(34)=STR(TT2[2]:Z1$),Y5$(47)=STR(TT2[3]:Z2$)
6730 Y5$(58)=STR(TT2[4]:Z1$),Y5$(71)=STR(TT2[5]:Z1$),Y5$(84)=STR(TT2[6]:Z1$)
6735 Y5$(96)=STR(TT2[7]:Z1$),Y5$(109)=STR(TT2[8]:Z1$),Y5$(122)=STR(TT2[9]:Z2$)
6740 IF V0$(74,1)="Y" THEN Y5$(133)=STR(TT2[10]:Z1$),Y5$(145)=STR(TT2[11]:Z1$),Y5$(157)=STR(TT2[12]:Z1$),Y5$(168)=STR(TT2[13]:Z1$),Y5$(180)=STR(TT2[14]:Z1$),Y5$(191)=STR(TT2[15]:Z1$)
6750 GOSUB 7300
6790 RETURN 
6800 REM "READ TOTALS FILE
6810 READ (Z[11],KEY="",DOM=6811)
6820 READ (Z[11],END=6890)IOL=0350
6830 GOSUB 6700
6880 GOTO 6820
6890 RETURN 
7000 REM "Totals logic
7001 IF T=T0 THEN IF T[T0,0]<2 THEN GOSUB 7300; GOTO 7100
7002 IF W+3>W0 THEN GOSUB 6000
7005 ON T GOTO 7006,7006,7006,7007,7008
7006 Y5$(19)=T1$(1,13),Y5$(32)=T1$(1,13),Y5$(45)=T1$(1,12); IF T>1 THEN GOTO 7009
7007 Y5$(57)=T1$(1,13),Y5$(70)=T1$(1,13),Y5$(83)=T1$(1,12); IF T>1 THEN GOTO 7009
7008 Y5$(95)=T1$(1,13),Y5$(108)=T1$(1,13),Y5$(121)=T1$(1,12)
7009 GOSUB 7300
7010 IF MID(V0$,74,1)="Y" AND T=4 THEN Y5$(157)=T1$(1,12),Y5$(191)=T1$(1,12) ELSE IF MID(V0$,74,1)="Y" AND T=3 THEN Y5$(145)=T1$(1,12),Y5$(180)=T1$(1,12) ELSE IF MID(V0$,74,1)="Y" AND T=1 THEN Y5$(133)=T1$(1,72) ELSE IF MID(V0$,74,1)="Y" AND T=1 THEN Y5$(133)=T1$(1,72) ELSE IF MID(V0$,74,1)="Y" AND T=2 THEN Y5$(133)=T1$(1,12),Y5$(168)=T1$(1,12) ELSE IF T=0 AND MID(V0$,74,1)="Y" THEN Y5$(133)=T1$(1,72)
7011 GOSUB 7300
7014 Y5$(1)=T3$(1,T0+1-T)+" "
7015 IF T$<>"" THEN Y5$(T0+2-T)=T$+" Total ("+STR(T[T,0]:"0")+"):"
7020 ON T GOTO 7025,7025,7025,7030,7035
7025 Y5$(20)=STR(T[T,1]:Z0$),Y5$(33)=STR(T[T,2]:Z0$),Y5$(46)=STR(T[T,3]:Z3$); IF T>1 THEN GOTO 7040
7030 Y5$(57)=STR(T[T,4]:Z0$),Y5$(70)=STR(T[T,5]:Z0$),Y5$(83)=STR(T[T,6]:Z3$); IF T>1 THEN GOTO 7040
7035 Y5$(95)=STR(T[T,7]:Z0$),Y5$(108)=STR(T[T,8]:Z0$),Y5$(121)=STR(T[T,9]:Z3$)
7040 IF V0$(74,1)="Y" AND T=3 THEN Y5$(145)=STR(T[T,11]:Z1$),Y5$(180)=STR(T[T,14]:Z1$) ELSE IF V0$(74,1)="Y" AND T=4 THEN Y5$(157)=STR(T[T,12]:Z1$),Y5$(191)=STR(T[T,15]:Z1$) ELSE IF V0$(74,1)="Y" AND T=2 THEN Y5$(133)=STR(T[T,10]:Z1$),Y5$(168)=STR(T[T,13]:Z1$) ELSE IF V0$(74,1)="Y" AND T=1 THEN Y5$(133)=STR(T[T,10]:Z1$),Y5$(145)=STR(T[T,11]:Z1$),Y5$(157)=STR(T[T,12]:Z1$),Y5$(168)=STR(T[T,13]:Z1$),Y5$(180)=STR(T[T,14]:Z1$),Y5$(191)=STR(T[T,15]:Z1$) ELSE IF V0$(74,1)="Y" AND T=0 THEN Y5$(133)=STR(T[T,10]:Z1$),Y5$(145)=STR(T[T,11]:Z1$),Y5$(157)=STR(T[T,12]:Z1$),Y5$(168)=STR(T[T,13]:Z1$),Y5$(180)=STR(T[T,14]:Z1$),Y5$(191)=STR(T[T,15]:Z1$)
7042 GOSUB 7300
7065 IF T$="END" THEN Y5$(19)=T2$(1,13),Y5$(32)=T2$(1,13),Y5$(45)=T2$(1,12),Y5$(57)=T2$(1,13),Y5$(70)=T2$(1,13),Y5$(83)=T2$(1,12),Y5$(95)=T2$(1,13),Y5$(108)=T2$(1,13),Y5$(121)=T2$(1,12); GOSUB 7300
7090 IF T0$="END" THEN IF T=0 THEN GOSUB 7200; GOTO 7190
7095 GOSUB 7300
7100 REM "Accumulate sub totals
7110 IF T=0 THEN GOTO 7190
7120 FOR X=0 TO T1
7130 T[T-1,X]=T[T-1,X]+T[T,X],T[T,X]=0
7140 NEXT X
7190 RETURN 
7200 REM "Elapsed time routine"
7205 GOSUB 7300; Y5$(1)="Number of items printed: "+STR(T[0,0]); GOSUB 7300
7210 PRECISION 14; T2=TIM-T2
7220 IF INT(T2)>0 THEN T4$=STR(INT(T2))+" Hours " ELSE T4$=""
7230 T3=INT(FPT(T2)*3600)
7240 T3=T3/60
7250 T4$=T4$+STR(T3:"##.##")+" Minutes"
7260 Y5$(1)="Elapsed time: "+T4$; GOSUB 7300
7280 PRECISION 2
7290 RETURN 
7300 REM "Output line Y5$ to output device
7305 IF R6$(1,1)="Y" THEN CALL "ZR2DNL",ERR=7306,X3$,X4$,Y5$,R6$; REM "Signal start of a new document, the key is system dat e+audit control #                                                          
7310 IF POS("V"=W8$)>0 THEN CALL "ZZVIEW",X3$,0,0,W3,W9,W,W9$,Y5$; GOTO 7390
7320 W=W+1; IF POS(" "<>Y5$)=0 THEN PRINT (W9)"" ELSE PRINT (W9)Y5$; Y5$(1)=""
7330 REM 
7390 IF W>=W0 THEN GOSUB 6000
7395 RETURN 
7400 REM "Read report selection parameters"
7410 Z$="12O ZZP     "
7420 CALL "ZZFLES",X3$,Y1$,Y0$,Z$,Z{ALL},Z0,0; ON Z0 GOTO 7421,9900
7430 Y3$=X3$(1,6),Y4$=X3$(178,7)
7450 READ (Z[12],KEY=X3$(1,8),DOM=7451)IOL=0420
7480 X3$(178,7)=Y4$,V0=NUM(V0$(71,1)),W3$=V0$(19,POS("   "=V0$(19,40)+"   ")-1)
7485 FOR U1=1 TO LEN(V1$); IF V1$(U1,1)=" " THEN V1$(U1,1)="."; NEXT U1 ELSE NEXT U1
7490 RETURN 
7500 REM "CUSTOM PROGRAMMING ROUTINES
7525 REM "Modified stmts:
7550 REM "Added stmts:
7575 REM "Deleted stmts:
7700 REM "PRINT P/E DATE"
7710 FIND (Z[6],DOM=7711,KEY=X3$(9,3)+"G/LYE"+A$(1,4))P1$
7720 Y5$(81)="Ending "+FND$(P1$(NUM(A$(5,2))*6+15,6))
7749 RETURN 
8100 REM "GOSUB here, once, at the beginning, after the background is set and before the Proceed? question. Set T to total # to do (by calling ZZINFO) and T0 to the reporting interval (report every T0 number of records) this is typically 2% of total; This also prints a message (@8115),so adjust accordingly
8110 CALL "ZZINFO",Z[1],T9,X3$,T,T0,K,B,D,S0,S1,F$
8130 T0=INT(T*.02); IF T0<=1 THEN T0=2
8135 C=0,T1=0
8145 RETURN 
8150 REM "Call this each time to update the bar graph. Display horiz. bar graph given total #, T and current #, C, and time counter T1 (T1 is init'ed here and used here, just don't use it somewhere else)
8155 CALL "ZZBARG",X3$,"HG",19,10,50,T1,T,C
8195 RETURN 
8200 REM "Remove AS3 record based on record from sort file gen'ed by AR2RHB
8201 REM "since multiple recs may have been placed in sort file, the DOM will skip the records that don't match exactly.
8210 C=C+1; IF MOD(C,T0)=1 THEN GOSUB 8150
8215 REMOVE (Z[7],KEY=U$(1,26),DOM=8216)
8245 GOTO 1000
9000 REM "ERROR PROCESSING
9010 Y5=ERR,Y6=TCB(5)
9015 SETERR 9016; Y8$=LST(PGM(Y6))
9016 SETERR 9000
9040 CALL "ZZERRM",Y8$,X0$,Y7$,X3$,Y5,Y6,Y7,Y8,0
9050 ON Y7 GOTO 9060,9100,9800,9070,9090
9060 RETRY 
9070 SETERR 9080
9075 EXECUTE Y7$
9080 SETERR 9000; RETRY 
9090 SETERR 0000; RETRY 
9100 REM " TRANSFER CONTROL
9180 GOTO 1000
9190 GOTO 9800
9300 SETESC 9350
9310 SETERR 9350
9315 IF X3$(47,1)="N" THEN RETURN ELSE SETESC 0000; RETURN 
9350 SETERR 9000; RETURN 
9900 REM "End program
9905 IF POS("V"=W8$)>0 THEN GOSUB 6000
9910 CALL "ZZERPT",X3$,X4$,X0$,Y3$,Y4$,W9,W2,W5,W,W0,W8,T3,V3$
9915 IF T9=1 AND V3$(2,1)<>"T" THEN GOSUB 5300
9920 CALL "ZZFLES",X3$,Y1$,Y0$,"END",Z{ALL},0,0
9925 IF V0$(73,1)="Y" THEN ERASE F0$
9930 IF Y4$<>"" THEN RUN Y4$,ERR=9931
9940 IF %GUI THEN EXIT ELSE RUN "ZMENU" ! SSP243169 jdf
9999 END 
56000 REM "208463-see 207882 - If using Veratax and you delete a sales tax 
56001 ! "219370-New Taxware State file, do download for this state, use tax 
56002 REM "240377-Sales Tax Payable report not clearing if using vera tax.    
56003 REM "248556-Add 1 additional space to Sales tax payable report after the
56004 REM "307229-Security by Operator to prevent clearing of Sales Tax Payabl
